# Multi-Agent System (MAS) Functional Requirements Specification

**Translation and Integration of French Requirements**  
**Based on**: CrewAI Multi-Agent Framework  
**Phase**: Phase 3 - Advanced Features

---

## I. Introduction and Objectives

### 1.1 Project Objectives

The Multi-Agent System (MAS) aims to create an autonomous project management and knowledge platform. It must significantly reduce management time (triage, assignment, documentation) and optimize development efficiency through the integration of effort estimation and AI assistance.

### 1.2 Functional Scope

The MAS will cover the following functional domains:

- Task and workflow management (Jira-like)
- Knowledge base and documentation management (Confluence-like)
- Human resources and skills management
- Auto-estimation of development effort
- Multi-agent orchestration and autonomous decision-making

---

## II. Agents and Their Key Functions (Detailed Functional Requirements)

### A. Requirements for Triage/Planning Agent (Task Management)

| ID | Functional Requirement | Detailed Description | Agent |
|----|------------------------|---------------------|-------|
| **EF-T.1** | Automatic Triage and Classification | The system must analyze a new task description and automatically assign it a type (Bug, Feature, Improvement) and priority. | Triage Agent |
| **EF-T.2** | Assignment Workflow Trigger | The agent must initiate the assignment process by querying the Resources Agent as soon as a ticket is validated. | Triage Agent |
| **EF-T.3** | Automated Status Management | The agent must advance the task through the workflow (e.g., To Do → In Progress → Review → Done) based on actions from other agents (e.g., code generated by the AI Dev Agent). | Triage Agent |
| **EF-T.4** | Blockage Detection and Alert | The agent must identify tasks that exceed the 50% estimation without updates or are blocked by external dependencies, and alert the Monitoring Agent. | Monitoring Agent |

**Agent Responsibilities**:
- Receive new task/ticket creation events
- Analyze task description using LLM
- Classify task type and priority
- Trigger assignment workflow
- Update task status based on agent actions
- Detect and report blockages

---

### B. Requirements for Resources Agent (Skills and Assignment)

| ID | Functional Requirement | Detailed Description | Agent |
|----|------------------------|---------------------|-------|
| **EF-R.1** | Skills Matrix (CRUD) | The system must allow storing, updating, and consulting skills for each profile (human or AI) with an expertise level (e.g., 1 to 5). | Resources Agent |
| **EF-R.2** | Availability/Workload Tracking | The agent must maintain a real-time view of current workload (occupation rate) for each resource based on assigned tasks and their estimations. | Resources Agent |
| **EF-R.3** | Optimized Assignee Suggestion | The system must suggest the optimal assignee by cross-referencing three criteria: 1) Required Skills, 2) Current Availability, and 3) History (minimize onboarding). | Resources Agent |
| **EF-R.4** | Assignment Justification | The system must provide a synthetic justification for its assignee choice. | Resources Agent |

**Agent Responsibilities**:
- Maintain skills database for all team members
- Track current workload and availability
- Calculate optimal assignment based on multiple criteria
- Provide assignment recommendations with justification
- Update workload metrics in real-time

---

### C. Requirements for Estimation Agent (Auto-Estimation and AI Factor)

| ID | Functional Requirement | Detailed Description | Agent |
|----|------------------------|---------------------|-------|
| **EF-E.1** | Dual Effort Estimation | For any development task, the agent must provide two distinct estimations: (1) Manual (T1) and (2) AI-Assisted (T2). | Estimation Agent |
| **EF-E.2** | AI Fit Rate Calculation | The system must evaluate the potential gain for a task (T1 - T2) and the reliability of AI generation to recommend the optimal scenario (AI or Manual). | Estimation Agent |
| **EF-E.3** | Historical Integration | The T1 estimation calculation must be calibrated based on completion times of historically similar tasks. | Estimation Agent |
| **EF-E.4** | AI Sub-Task Creation | If the "AI-Assisted" scenario is recommended and validated, the Estimation Agent must automatically create sub-tasks for the AI Developer Agent (generation) and the Test/Quality Agent (validation). | Estimation Agent |

**Agent Responsibilities**:
- Analyze task complexity and requirements
- Estimate manual development time (T1) using historical data
- Estimate AI-assisted development time (T2)
- Calculate AI fit rate and recommend approach
- Create sub-tasks for AI-assisted workflows
- Learn from historical completion times

---

### D. Requirements for Documentation Agent (Knowledge Management)

| ID | Functional Requirement | Detailed Description | Agent |
|----|------------------------|---------------------|-------|
| **EF-D.1** | Draft Documentation Generation | The agent must automatically generate a draft of technical or user documentation page (Confluence-like) when a feature status changes to Done. | Documentation Agent |
| **EF-D.2** | Information Extraction | The agent must extract relevant information for documentation from the ticket (initial description, comments, design decisions, code changes). | Documentation Agent |
| **EF-D.3** | Knowledge Base Maintenance | The agent must update existing knowledge pages if a new feature modifies a previously documented behavior. | Knowledge Agent |

**Agent Responsibilities**:
- Monitor task/feature completion status
- Extract relevant information from tickets and code
- Generate documentation drafts using LLM
- Update existing documentation when features change
- Maintain knowledge base structure and organization

---

## III. Technical and Non-Functional Requirements

### 3.1 MAS Architecture

**ENF-A.1**: The system must be based on a multi-agent orchestration framework (CrewAI).

**ENF-A.2**: Agents must be able to communicate asynchronously via an internal messaging protocol.

**ENF-A.3**: The system must use LLMs (Large Language Models) for interpretation, text generation, and estimation.

**Architecture Components**:
- **CrewAI Framework**: Multi-agent orchestration
- **Agent Communication**: Asynchronous message passing
- **Agent Memory**: Persistent memory for each agent
- **Agent Tools**: Custom tools for each agent (database access, API calls, etc.)
- **Crew Orchestration**: Sequential, hierarchical, or hybrid processes
- **State Management**: Persist execution state for long-running workflows

---

### 3.2 Performance

**ENF-P.1**: The complete process of triage, assignment, and estimation for a new ticket must be completed in less than 15 seconds.

**ENF-P.2**: Knowledge base search (RAG) must return relevant results in less than 5 seconds.

**Performance Targets**:
- Triage and classification: < 3 seconds
- Resource assignment: < 5 seconds
- Effort estimation: < 7 seconds
- Documentation generation: < 30 seconds (async)
- RAG search: < 5 seconds

---

### 3.3 Integration and Security

**ENF-S.1**: The system must guarantee the confidentiality of skills profiles and workload data.

**ENF-S.2**: The MAS must integrate via API to read and write in the version control tool (Git) and the ticket management tool (Jira/similar, if existing).

**Integration Points**:
- REST API to create/update tasks
- Git integration for code analysis
- Database integration for skills and workload
- Knowledge base (PostgreSQL + pgvector) for RAG
- Notification system for alerts

---

## IV. Agent Specifications

### Agent 1: Triage Agent

**Role**: Task Triage and Classification  
**Goal**: Automatically classify and prioritize incoming tasks  
**Backstory**: Expert in understanding task requirements and classifying them efficiently  
**Tools**:
- Task creation API
- LLM for analysis
- Priority calculation algorithm
- Status workflow manager

**CrewAI Configuration**:
```python
triage_agent = Agent(
    role='Task Triage Specialist',
    goal='Accurately classify and prioritize tasks for optimal workflow',
    backstory='Expert in analyzing task descriptions and understanding project context',
    tools=[task_api_tool, llm_analyzer_tool],
    verbose=True,
    allow_delegation=True
)
```

---

### Agent 2: Resources Agent

**Role**: Resource and Skills Management  
**Goal**: Optimize task assignment based on skills and availability  
**Backstory**: Maintains comprehensive knowledge of team skills and current workload  
**Tools**:
- Skills database access
- Workload calculator
- Assignment optimizer
- Availability tracker

**CrewAI Configuration**:
```python
resources_agent = Agent(
    role='Resource Allocation Manager',
    goal='Assign tasks to optimal team members based on skills and availability',
    backstory='Expert in resource management with deep understanding of team capabilities',
    tools=[skills_db_tool, workload_calculator_tool, assignment_optimizer_tool],
    verbose=True,
    allow_delegation=False
)
```

---

### Agent 3: Estimation Agent

**Role**: Development Effort Estimation  
**Goal**: Provide accurate time estimates for manual and AI-assisted development  
**Backstory**: Expert in analyzing task complexity and historical performance  
**Tools**:
- Historical data analyzer
- Complexity calculator
- AI capability assessor
- Sub-task generator

**CrewAI Configuration**:
```python
estimation_agent = Agent(
    role='Development Effort Estimator',
    goal='Provide accurate time estimates for both manual and AI-assisted development',
    backstory='Expert in software development estimation with access to historical data',
    tools=[historical_analyzer_tool, complexity_calculator_tool, ai_assessor_tool],
    verbose=True,
    allow_delegation=True
)
```

---

### Agent 4: Documentation Agent

**Role**: Knowledge Base Management  
**Goal**: Generate and maintain comprehensive documentation  
**Backstory**: Expert technical writer with deep understanding of the codebase  
**Tools**:
- Documentation generator
- Code analyzer
- Knowledge base updater
- Information extractor

**CrewAI Configuration**:
```python
documentation_agent = Agent(
    role='Technical Documentation Specialist',
    goal='Generate and maintain accurate technical documentation',
    backstory='Expert technical writer with deep understanding of software systems',
    tools=[doc_generator_tool, code_analyzer_tool, kb_updater_tool],
    verbose=True,
    allow_delegation=False
)
```

---

### Agent 5: Monitoring Agent (Optional)

**Role**: System Monitoring and Alerting  
**Goal**: Monitor task progress and detect blockages  
**Backstory**: Vigilant system monitor with pattern recognition capabilities  
**Tools**:
- Task status monitor
- Blockage detector
- Alert system
- Metrics collector

---

## V. CrewAI Implementation Strategy

### Crew Structure

**Task Triage Crew**:
- Agents: Triage Agent, Resources Agent
- Process: Sequential (triage → assignment)
- Tasks: Classify task → Suggest assignee

**Estimation Crew**:
- Agents: Estimation Agent, Resources Agent (for context)
- Process: Sequential
- Tasks: Estimate effort → Create sub-tasks if AI-assisted

**Documentation Crew**:
- Agents: Documentation Agent, Knowledge Agent
- Process: Sequential
- Tasks: Extract info → Generate docs → Update knowledge base

**Main Orchestration Flow**:
```
New Task → Triage Crew → Estimation Crew → Assignment → 
Development → Documentation Crew → Knowledge Base Update
```

### CrewAI Features to Leverage

1. **Memory**: Each agent maintains memory of past decisions
2. **Tools**: Custom tools for database access, API calls
3. **Flows**: Orchestrate agent interactions
4. **Callbacks**: Human-in-the-loop for critical decisions
5. **State Persistence**: Resume long-running workflows
6. **Observability**: Monitor agent decisions and actions

---

## VI. Integration with Phase 3 Development

### Phase 3.1: AI Infrastructure Setup (Week 1-2)

**Tasks**:
- [ ] Install and configure CrewAI
- [ ] Set up agent communication layer
- [ ] Create base agent class with common tools
- [ ] Configure LLM providers (OpenAI API)
- [ ] Set up agent memory storage (PostgreSQL)

### Phase 3.2: Core Agents Development (Week 3-6)

**Tasks**:
- [ ] Implement Triage Agent
- [ ] Implement Resources Agent
- [ ] Implement Estimation Agent
- [ ] Implement Documentation Agent
- [ ] Create agent tools (database access, API integration)
- [ ] Set up agent-to-agent communication

### Phase 3.3: Crew Orchestration (Week 7-10)

**Tasks**:
- [ ] Create Task Triage Crew
- [ ] Create Estimation Crew
- [ ] Create Documentation Crew
- [ ] Implement main orchestration flow
- [ ] Add state persistence
- [ ] Implement error handling and retries

### Phase 3.4: Integration and Testing (Week 11-12)

**Tasks**:
- [ ] Integrate with task management system
- [ ] Integrate with Git
- [ ] Performance optimization (< 15s for triage+assignment+estimation)
- [ ] RAG optimization (< 5s search)
- [ ] Security and access control
- [ ] End-to-end testing

---

## VII. Data Model

### Skills Matrix
```sql
CREATE TABLE agent_skills (
    id UUID PRIMARY KEY,
    agent_id UUID REFERENCES agents(id),
    skill_name VARCHAR(100),
    expertise_level INTEGER CHECK (expertise_level BETWEEN 1 AND 5),
    domain VARCHAR(50),
    created_at TIMESTAMP,
    updated_at TIMESTAMP
);
```

### Workload Tracking
```sql
CREATE TABLE agent_workload (
    id UUID PRIMARY KEY,
    agent_id UUID REFERENCES agents(id),
    current_tasks INTEGER,
    estimated_hours DECIMAL,
    available_capacity DECIMAL,
    last_updated TIMESTAMP
);
```

### Estimation History
```sql
CREATE TABLE task_estimations (
    id UUID PRIMARY KEY,
    task_id UUID REFERENCES tasks(id),
    manual_estimate DECIMAL,
    ai_assisted_estimate DECIMAL,
    recommended_approach VARCHAR(20),
    actual_time DECIMAL,
    accuracy_score DECIMAL,
    created_at TIMESTAMP
);
```

---

## VIII. Success Metrics

### Performance Metrics
- Average triage time: < 3 seconds
- Average assignment time: < 5 seconds
- Average estimation time: < 7 seconds
- RAG search latency: < 5 seconds
- Documentation generation: < 30 seconds

### Quality Metrics
- Classification accuracy: > 90%
- Assignment satisfaction: > 85%
- Estimation accuracy: ±20% within actual time
- Documentation completeness: > 80%

### Adoption Metrics
- Agent-assisted task creation: > 70%
- AI-assisted development adoption: > 50% (when recommended)
- Documentation auto-generation: > 90% of completed features

---

**Document Status**: Integration with Phase 3  
**Implementation Framework**: CrewAI  
**Timeline**: Weeks 1-12 of Phase 3

